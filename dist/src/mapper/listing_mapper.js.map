{"version":3,"sources":["mapper/listing_mapper.ts"],"names":[],"mappings":";AAAA,IAAO,OAAO,WAAW,MAAM,CAAC,CAAC;AACjC,IAAM,KAAK,GAAG,OAAO,CAAC,OAAO,CAAC,CAAC;AAC/B;IAMI,uBAAY,IAAS;QACjB,IAAI,CAAC,IAAI,GAAG,IAAI,CAAC;IACrB,CAAC;IAEM,+BAAO,GAAd;QAAA,iBAMC;QALG,IAAI,CAAC,WAAW,GAAG,EAAE,CAAC;QACtB,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,OAAO,CAAC,CAAC,OAAO,CAAC,UAAC,GAAG;YAClC,KAAI,CAAC,WAAW,CAAC,GAAG,CAAC,GAAG,KAAI,CAAC,OAAO,CAAC,GAAG,EAAE,KAAI,CAAC,OAAO,CAAC,CAAC;QAC5D,CAAC,CAAC,CAAC;QACH,MAAM,CAAC,IAAI,CAAC,WAAW,CAAC;IAC5B,CAAC;IACO,+BAAO,GAAf,UAAgB,GAAU,EAAE,OAAW;QACnC,IAAI,MAAM,GAAG,OAAO,CAAC,GAAG,CAAC,CAAC;QAC1B,MAAM,CAAC,CAAC,OAAO,MAAM,CAAC,CAAC,CAAC;YACpB,KAAK,QAAQ;gBACT,MAAM,CAAC,IAAI,CAAC,aAAa,CAAC,MAAM,CAAC,CAAC;YACtC,KAAK,QAAQ;gBACT,IAAI,GAAG,GAAG,EAAE,CAAC;gBACb,GAAG,CAAA,CAAC,IAAI,CAAC,IAAI,MAAM,CAAC,CAAC,CAAC;oBAClB,GAAG,CAAC,CAAC,CAAC,GAAG,IAAI,CAAC,OAAO,CAAC,CAAC,EAAE,MAAM,CAAC,CAAC;gBACrC,CAAC;gBACD,MAAM,CAAC,GAAG,CAAC;YACf,KAAK,UAAU;gBACX,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;YAC7B;gBACI,MAAM,CAAC,EAAE,CAAC;QAClB,CAAC;IACL,CAAC;IACO,qCAAa,GAArB,UAAsB,WAAkB;QACpC,MAAM,CAAC,IAAI,CAAC,OAAO,EAAE,CAAC,WAAW,CAAC,CAAC;IACvC,CAAC;IAEO,+BAAO,GAAf;QACI,EAAE,CAAA,CAAC,OAAO,IAAI,CAAC,UAAU,KAAK,WAAW,CAAC,CAAC,CAAC;YACxC,IAAI,CAAC,UAAU,GAAG,OAAO,CAAC,IAAI,CAAC,IAAI,CAAC,CAAC;QACzC,CAAC;QACD,MAAM,CAAC,IAAI,CAAC,UAAU,CAAC;IAC3B,CAAC;IAES,wCAAgB,GAA1B,UAA2B,IAAS,EAAE,UAAiB;QAAvD,iBAWC;QAXqC,0BAAiB,GAAjB,iBAAiB;QACnD,IAAI,MAAM,GAAG,EAAE,CAAC;QAChB,EAAE,CAAC,CAAC,CAAC,IAAI,CAAC;YAAC,MAAM,CAAC,MAAM,CAAC;QACzB,EAAE,CAAC,CAAC,IAAI,CAAC,WAAW,KAAK,KAAK,CAAC,CAAC,CAAC;YAC7B,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,UAAU,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,CAAA;QAClD,CAAC;QAAC,IAAI,CAAC,CAAC;YACJ,IAAI,CAAC,OAAO,CAAC,UAAC,IAAW;gBACrB,MAAM,CAAC,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,IAAI,EAAE,UAAU,CAAC,CAAC,CAAA;YAClD,CAAC,CAAC,CAAC;QACP,CAAC;QACD,MAAM,CAAC,MAAM,CAAC;IAClB,CAAC;IAES,kCAAU,GAApB,UAAqB,MAAa,EAAE,UAAiB;QAAjB,0BAAiB,GAAjB,iBAAiB;QACjD,EAAE,CAAC,CAAC,UAAU,CAAC,CAAC,CAAC;YACb,MAAM,CAAC,KAAK,CAAC,UAAU,CAAC,MAAM,CAAC,OAAO,CAAC,KAAK,EAAE,EAAE,CAAC,CAAC,CAAC;QACvD,CAAC;QAAC,IAAI,CAAC,CAAC;YACJ,MAAM,CAAC,MAAM,CAAC;QAClB,CAAC;IACL,CAAC;IAES,sCAAc,GAAxB,UAAyB,KAAoB,EAAE,UAAe,EAAE,MAAoB,EAAE,UAAiB;QAAvG,iBAWC;QAX+D,sBAAoB,GAApB,aAAoB;QAAE,0BAAiB,GAAjB,iBAAiB;QACnG,IAAI,MAAM,GAAiB,EAAE,CAAC;QAC9B,EAAE,CAAC,CAAC,CAAC,UAAU,CAAC;YAAC,MAAM,CAAC,MAAM,CAAC;QAC/B,KAAK,CAAC,OAAO,CAAC,UAAC,IAAI;YACf,IAAI,KAAK,GAAG,UAAU,CAAC,IAAI,CAAC,IAAI,MAAM,CAAC;YACvC,EAAE,CAAC,CAAC,KAAK,CAAC,CAAC,CAAC;gBACR,IAAI,GAAG,GAAG,IAAI,CAAC,OAAO,CAAC,MAAM,EAAE,EAAE,CAAC,CAAC;gBACnC,MAAM,CAAC,IAAI,CAAC,KAAI,CAAC,UAAU,CAAC,GAAG,EAAE,UAAU,CAAC,CAAC,CAAA;YACjD,CAAC;QACL,CAAC,CAAC,CAAA;QACF,MAAM,CAAC,MAAM,CAAC;IAClB,CAAC;IACL,oBAAC;AAAD,CA9EA,AA8EC,IAAA;AA4BO,qBAAa,iBA5BpB;AA4BqB","file":"mapper/listing_mapper.js","sourcesContent":["import flatten = require('flat');\nconst humps = require('humps');\nclass ListingMapper {\n    outputClass:any;\n    public key_map:KeyMap;\n    private json:any;\n    private flatenJSON:any;\n\n    constructor(json: any) {\n        this.json = json;\n    }\n\n    public mapData() {\n        this.outputClass = {};\n        Object.keys(this.key_map).forEach((key)=>{\n            this.outputClass[key] = this.extract(key, this.key_map);\n        });\n        return this.outputClass;\n    }\n    private extract(key:string, key_map:any) {\n        var action = key_map[key];\n        switch (typeof action) {\n            case 'string':\n                return this.extractString(action);\n            case 'object':\n                var obj = {};\n                for(var k in action) {\n                    obj[k] = this.extract(k, action);\n                }\n                return obj;\n            case 'function':\n                return action(this.json);\n            default:\n                return {};\n        }\n    }\n    private extractString(flatten_key:string) {\n        return this.flatten()[flatten_key];\n    }\n\n    private flatten() {\n        if(typeof this.flatenJSON === 'undefined') {\n            this.flatenJSON = flatten(this.json);\n        }\n        return this.flatenJSON;\n    }\n\n    protected extractArrayData(data: any, decamelize = true):Array<any> {\n        var result = [];\n        if (!data) return result;\n        if (data.constructor !== Array) {\n            result.push(this.decamelize(data, decamelize))\n        } else {\n            data.forEach((item:string) => {\n                result.push(this.decamelize(item, decamelize))\n            });\n        }\n        return result;\n    }\n\n    protected decamelize(string:string, decamelize = true) {\n        if (decamelize) {\n            return humps.decamelize(string.replace(/\\W/g, ''));\n        } else {\n            return string;\n        }\n    }\n\n    protected extractBoolKey(array: Array<string>, source_obj: any, prefix:string = null, decamelize = true):Array<string> {\n        var result:Array<string> = [];\n        if (!source_obj) return result;\n        array.forEach((item) => {\n            var value = source_obj[item] == 'true';\n            if (value) {\n                var str = item.replace(prefix, '');\n                result.push(this.decamelize(str, decamelize))\n            }\n        })\n        return result;\n    }\n}\n\nexport interface KeyMap {\n    address: any,\n    show_address: any,\n    price: any,\n    area: any,\n    neighborhood: any,\n    description: any,\n    amenities: any,\n    property_features: any,\n    rooms: any,\n    bathrooms: any,\n    bedrooms: any,\n    images: any,\n    location: any,\n    property_type: any,\n    source_type: any,\n    source_key: any,\n    source_category: any,\n    source_status: any,\n    source_participants: any,\n    provider: any,\n    additional_detail: any,\n    pet_allowed: any,\n    status: any\n}\n\nexport {ListingMapper}\n"],"sourceRoot":"./src"}